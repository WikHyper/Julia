<!--
Save as index.html and open in browser.
Edit names/date details here: GIRLFRIEND_NAME, MY_NAME, DATE_IDEA, DATE_TIME, PROMISE, COUNTDOWN_TARGET, LOVE_LETTER, PS_LINE.
Unsplash source links require internet; background falls back to a soft gradient if images fail.
-->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Will You Be My Valentine?</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Parisienne&family=Playfair+Display:wght@600;700&family=Quicksand:wght@400;600&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg-image: none;
      --pink-1: #ffd1dc;
      --pink-2: #ff9ec4;
      --pink-3: #ff5f9e;
      --pink-4: #d83a7a;
      --cream: #fff7fb;
      --text: #3a1a2e;
      --card-bg: rgba(255, 255, 255, 0.86);
      --shadow: 0 24px 60px rgba(216, 58, 122, 0.22);
      --outline: rgba(255, 95, 158, 0.25);
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      min-height: 100vh;
      font-family: "Quicksand", "Segoe UI", sans-serif;
      color: var(--text);
      background-image: var(--bg-image), linear-gradient(145deg, #ffe6ef, #ffd0e0 40%, #fff1f7 85%);
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
      overflow-x: hidden;
    }

    body.loaded .card {
      animation: cardIn 0.9s ease both;
    }

    .bg-overlay {
      position: fixed;
      inset: 0;
      background: radial-gradient(circle at top, rgba(255, 255, 255, 0.4), rgba(255, 219, 234, 0.6));
      pointer-events: none;
      z-index: 0;
    }

    .floating-hearts {
      position: fixed;
      inset: 0;
      pointer-events: none;
      overflow: hidden;
      z-index: 1;
    }

    .floating-hearts span {
      position: absolute;
      left: var(--x);
      bottom: -15%;
      font-size: var(--size);
      opacity: var(--opacity);
      filter: blur(0.2px);
      animation: floatUp var(--duration) linear infinite;
      animation-delay: var(--delay);
    }

    .page {
      position: relative;
      z-index: 2;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 18px;
      padding: 40px 16px 24px;
    }

    .stickers {
      position: absolute;
      inset: 0;
      pointer-events: none;
      z-index: 1;
    }

    .sticker {
      position: absolute;
      width: 140px;
      height: 140px;
      object-fit: cover;
      border-radius: 24px;
      opacity: 0.7;
      filter: blur(0.6px) saturate(1.1);
      box-shadow: 0 12px 30px rgba(0, 0, 0, 0.12);
      mix-blend-mode: screen;
    }

    .sticker.s1 {
      top: 8%;
      left: 4%;
      transform: rotate(-6deg);
    }

    .sticker.s2 {
      bottom: 12%;
      left: 8%;
      transform: rotate(8deg);
    }

    .sticker.s3 {
      top: 14%;
      right: 6%;
      transform: rotate(4deg);
    }

    .card {
      width: min(92vw, 640px);
      border-radius: 32px;
      background: linear-gradient(160deg, rgba(255, 214, 230, 0.7), rgba(255, 245, 250, 0.95));
      box-shadow: 0 30px 70px rgba(216, 58, 122, 0.25);
      border: 1px solid rgba(255, 255, 255, 0.9);
      position: relative;
      overflow: hidden;
      padding: 22px;
      backdrop-filter: blur(8px);
      perspective: 1200px;
    }

    .card::before {
      content: "";
      position: absolute;
      inset: 0;
      background:
        linear-gradient(150deg, rgba(255, 176, 205, 0.45), rgba(255, 255, 255, 0) 60%),
        linear-gradient(330deg, rgba(255, 210, 227, 0.55), rgba(255, 255, 255, 0) 55%);
      opacity: 0.9;
      pointer-events: none;
    }

    .card::after {
      content: "";
      position: absolute;
      inset: 0;
      background: linear-gradient(180deg, rgba(255, 170, 205, 0.55), rgba(255, 255, 255, 0));
      clip-path: polygon(0 0, 100% 0, 50% 58%);
      opacity: 0.6;
      pointer-events: none;
      transform-origin: top center;
      transition: transform 0.9s ease, opacity 0.9s ease;
    }

    .card-inner {
      position: relative;
      z-index: 1;
    }

    .card.opened::after {
      transform: rotateX(180deg) translateY(-10px);
      opacity: 0.2;
    }

    .card.opened .letter {
      transform: translateY(-6px);
    }

    .letter {
      position: relative;
      background-color: #fffdf8;
      background-image: repeating-linear-gradient(
        to bottom,
        rgba(255, 255, 255, 0) 0,
        rgba(255, 255, 255, 0) 26px,
        rgba(255, 190, 215, 0.25) 27px
      );
      border-radius: 22px;
      padding: 26px 26px 22px;
      border: 1px solid rgba(216, 58, 122, 0.18);
      box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.7), 0 14px 30px rgba(216, 58, 122, 0.18);
      overflow: hidden;
      transition: transform 0.8s ease;
    }

    .letter::before {
      content: "";
      position: absolute;
      left: 0;
      right: 0;
      top: 0;
      height: 44px;
      background: linear-gradient(180deg, rgba(255, 219, 234, 0.7), rgba(255, 255, 255, 0));
      pointer-events: none;
    }

    .letter::after {
      content: "❤";
      position: absolute;
      top: 16px;
      right: 18px;
      width: 56px;
      height: 56px;
      border-radius: 14px;
      background: linear-gradient(135deg, #ff6fa5, #d83a7a);
      color: #fff;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.4rem;
      box-shadow: 0 12px 24px rgba(216, 58, 122, 0.35);
      transform: rotate(6deg);
      pointer-events: none;
    }

    .letter-meta {
      display: flex;
      flex-wrap: wrap;
      gap: 8px 16px;
      justify-content: space-between;
      font-size: 0.78rem;
      text-transform: uppercase;
      letter-spacing: 0.18em;
      color: #b04870;
      margin-bottom: 14px;
      padding-right: 70px;
    }

    .letter-meta strong {
      font-weight: 700;
    }

    .letter-date {
      white-space: nowrap;
    }

    .eyebrow {
      text-transform: uppercase;
      letter-spacing: 0.28em;
      font-size: 0.7rem;
      font-weight: 600;
      color: #c23b6b;
      margin: 0 0 12px;
    }

    h1 {
      font-family: "Playfair Display", "Times New Roman", serif;
      font-size: clamp(1.8rem, 3.4vw, 2.6rem);
      margin: 0 0 10px;
      line-height: 1.2;
    }

    h2 {
      font-family: "Playfair Display", "Times New Roman", serif;
      font-size: clamp(1.3rem, 2.6vw, 1.9rem);
      margin: 0 0 10px;
      line-height: 1.25;
    }

    .name-script {
      font-family: "Parisienne", "Playfair Display", serif;
      font-size: 1.25em;
      color: #b0356a;
    }

    .subtext {
      margin: 0 0 18px;
      font-size: 1.05rem;
      color: rgba(58, 26, 46, 0.8);
    }

    .signature {
      margin: 10px 0 0;
      text-align: right;
      font-family: "Parisienne", "Playfair Display", serif;
      font-size: 1.4rem;
      color: #b0356a;
    }

    .cta-area {
      position: relative;
      width: min(420px, 100%);
      height: 160px;
      margin: 18px auto 8px;
      display: flex;
      align-items: flex-start;
      justify-content: center;
      padding-top: 8px;
    }

    .btn {
      border: none;
      border-radius: 999px;
      padding: 14px 30px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: transform 0.2s ease, box-shadow 0.2s ease, background 0.2s ease;
      font-family: "Quicksand", "Segoe UI", sans-serif;
    }

    .btn:focus-visible {
      outline: 3px solid var(--outline);
      outline-offset: 4px;
    }

    .btn.yes {
      background: radial-gradient(circle at top, #ff9cc2, #d83a7a 70%);
      color: white;
      box-shadow: 0 12px 24px rgba(255, 95, 158, 0.35);
      border: 2px solid rgba(255, 255, 255, 0.6);
      letter-spacing: 0.08em;
      text-transform: uppercase;
      animation: heartbeat 1.6s ease-in-out infinite;
    }

    .btn.yes:hover {
      transform: translateY(-2px) scale(1.02);
      box-shadow: 0 16px 30px rgba(255, 95, 158, 0.4);
    }

    .btn.no {
      position: absolute;
      left: 0;
      top: 0;
      background: rgba(255, 255, 255, 0.9);
      color: #c23b6b;
      border: 2px dashed rgba(194, 59, 107, 0.45);
      box-shadow: 0 10px 20px rgba(194, 59, 107, 0.16);
      will-change: transform;
    }

    .btn.ghost {
      background: rgba(255, 255, 255, 0.7);
      color: #a03562;
      border: 1px solid rgba(194, 59, 107, 0.3);
      box-shadow: none;
    }

    .hint,
    .tease {
      font-size: 0.95rem;
      margin: 6px 0 0;
      min-height: 20px;
      color: #a03562;
      text-align: center;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .hint.show,
    .tease.show {
      opacity: 1;
    }

    .sound-toggle {
      margin-top: 10px;
      display: flex;
      justify-content: center;
    }

    .sound-toggle button {
      background: transparent;
      border: 1px solid rgba(194, 59, 107, 0.3);
      color: #a03562;
      border-radius: 999px;
      padding: 6px 14px;
      font-size: 0.85rem;
      cursor: pointer;
    }

    .view {
      display: none;
    }

    .view.active {
      display: block;
      animation: fadeUp 0.6s ease both;
    }

    .success-emoji {
      font-size: 2.6rem;
      animation: bounce 1.2s ease-in-out infinite;
      margin-bottom: 8px;
    }

    .success-text {
      font-size: 1.05rem;
      margin: 6px 0 18px;
    }

    details {
      background: rgba(255, 255, 255, 0.7);
      border-radius: 18px;
      padding: 12px 14px;
      border: 1px solid rgba(194, 59, 107, 0.2);
      margin-top: 10px;
      box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.7);
    }

    details summary {
      cursor: pointer;
      font-weight: 600;
      color: #a03562;
    }

    details ul {
      margin: 10px 0 0;
      padding-left: 18px;
    }

    .love-letter {
      position: relative;
      margin-top: 14px;
    }

    .seal-note {
      margin: 0 0 10px;
      font-size: 0.9rem;
      color: #a03562;
    }

    .envelope {
      position: relative;
      height: 230px;
      border-radius: 20px;
      background:
        linear-gradient(160deg, #ffd6e5, #f7b6cf);
      box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.7), 0 16px 30px rgba(216, 58, 122, 0.16);
      overflow: visible;
      perspective: 900px;
    }

    .envelope-front {
      position: absolute;
      inset: 0;
      border-radius: 20px;
      pointer-events: none;
      background: linear-gradient(0deg, rgba(255, 255, 255, 0.92) 0 56%, transparent 56%);
      z-index: 3;
      transition: opacity 0.6s ease;
    }

    .envelope-front::before,
    .envelope-front::after {
      content: "";
      position: absolute;
      left: 0;
      bottom: 0;
      width: 50%;
      height: 70%;
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.92) 0 50%, transparent 50%);
    }

    .envelope-front::after {
      left: auto;
      right: 0;
      background: linear-gradient(225deg, rgba(255, 255, 255, 0.92) 0 50%, transparent 50%);
    }

    .envelope-flap {
      position: absolute;
      left: 0;
      top: -2px;
      width: 100%;
      height: 60%;
      border-radius: 18px;
      background: linear-gradient(180deg, #f9b9d4, #f4a6c6);
      clip-path: polygon(0 0, 100% 0, 50% 70%);
      transform-origin: top center;
      transition: transform 0.9s ease, filter 0.9s ease;
      z-index: 4;
      box-shadow: 0 12px 22px rgba(216, 58, 122, 0.2);
      pointer-events: none;
      backface-visibility: hidden;
    }

    .letter-paper {
      position: absolute;
      left: 10%;
      right: 10%;
      bottom: 18%;
      min-height: 160px;
      padding: 16px 14px;
      border-radius: 14px;
      background: #fffdf8;
      background-image: repeating-linear-gradient(
        to bottom,
        rgba(255, 255, 255, 0) 0,
        rgba(255, 255, 255, 0) 24px,
        rgba(255, 190, 215, 0.28) 25px
      );
      border: 1px solid rgba(216, 58, 122, 0.18);
      box-shadow: 0 10px 22px rgba(216, 58, 122, 0.18);
      transform: translateY(42%);
      transition: transform 0.8s ease;
      z-index: 2;
    }

    .letter-paper::before {
      content: "";
      position: absolute;
      inset: 10px 10px auto 10px;
      height: 8px;
      border-radius: 6px;
      background: linear-gradient(90deg, rgba(216, 58, 122, 0.2), transparent);
      opacity: 0.6;
    }

    .wax-seal {
      position: absolute;
      left: 50%;
      bottom: 38px;
      width: 66px;
      height: 66px;
      border-radius: 50%;
      border: none;
      transform: translateX(-50%);
      background: radial-gradient(circle at 30% 30%, #ff8fbb, #c72561 70%);
      color: #fff;
      font-size: 1.2rem;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      box-shadow: 0 12px 22px rgba(194, 59, 107, 0.35);
      transition: transform 0.2s ease, box-shadow 0.2s ease, opacity 0.3s ease;
      z-index: 5;
    }

    .wax-seal:focus-visible {
      outline: 3px solid var(--outline);
      outline-offset: 4px;
    }

    .wax-seal:hover {
      transform: translateX(-50%) translateY(-2px) scale(1.02);
    }

    .wax-seal.broken {
      opacity: 0.25;
      transform: translateX(-50%) translateY(18px) scale(0.92) rotate(-8deg);
      box-shadow: none;
      cursor: default;
    }

    .letter-body {
      opacity: 0;
      transform: translateY(6px);
      max-height: 0;
      overflow: hidden;
      transition: opacity 0.5s ease, transform 0.5s ease, max-height 0.6s ease;
      margin-top: 6px;
    }

    .love-letter.open .letter-body {
      opacity: 1;
      transform: translateY(0);
      max-height: 800px;
    }

    .love-letter.open .letter-paper {
      transform: translateY(-35%);
      z-index: 6;
    }

    .love-letter.open .envelope-flap {
      transform: rotateX(180deg);
      filter: brightness(0.95);
      z-index: 1;
      opacity: 0.2;
    }

    .love-letter.open .envelope-front {
      opacity: 0.25;
    }

    .love-letter-text {
      margin: 0;
      white-space: pre-wrap;
      line-height: 1.5;
      font-size: 1rem;
      color: rgba(58, 26, 46, 0.9);
      font-family: "Playfair Display", "Times New Roman", serif;
    }

    footer {
      font-size: 0.9rem;
      color: rgba(58, 26, 46, 0.7);
    }

    .confetti {
      position: fixed;
      inset: 0;
      pointer-events: none;
      overflow: hidden;
      z-index: 4;
    }

    .confetti-heart {
      position: absolute;
      top: -10%;
      left: var(--x);
      font-size: var(--size);
      opacity: 0.95;
      animation: confettiFall var(--duration) ease-in forwards;
      animation-delay: var(--delay);
      text-shadow: 0 8px 14px rgba(0, 0, 0, 0.12);
    }

    .sr-only {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      border: 0;
      white-space: nowrap;
    }

    @keyframes cardIn {
      0% {
        transform: translateY(16px) scale(0.98);
        opacity: 0;
      }
      100% {
        transform: translateY(0) scale(1);
        opacity: 1;
      }
    }

    @keyframes fadeUp {
      0% {
        opacity: 0;
        transform: translateY(12px);
      }
      100% {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes heartbeat {
      0%,
      100% {
        transform: scale(1);
      }
      50% {
        transform: scale(1.06);
      }
    }

    @keyframes bounce {
      0%,
      100% {
        transform: translateY(0);
      }
      50% {
        transform: translateY(-8px);
      }
    }

    @keyframes floatUp {
      0% {
        transform: translateY(0) translateX(0) scale(0.9);
      }
      50% {
        transform: translateY(-60vh) translateX(16px) scale(1);
      }
      100% {
        transform: translateY(-120vh) translateX(-8px) scale(1.1);
      }
    }

    @keyframes confettiFall {
      0% {
        transform: translateY(-10vh) rotate(0deg);
        opacity: 0;
      }
      12% {
        opacity: 1;
      }
      100% {
        transform: translateY(110vh) rotate(320deg);
        opacity: 0;
      }
    }

    @media (max-width: 640px) {
      .card {
        padding: 18px;
      }

      .cta-area {
        height: 180px;
      }

      .sticker {
        width: 110px;
        height: 110px;
        opacity: 0.55;
      }

      .letter {
        padding: 22px 18px 20px;
      }

      .letter-meta {
        gap: 6px 10px;
        padding-right: 60px;
        font-size: 0.72rem;
      }

      .envelope {
        height: 210px;
      }

      .letter-paper {
        left: 8%;
        right: 8%;
        min-height: 150px;
      }

      .wax-seal {
        width: 56px;
        height: 56px;
        font-size: 1.05rem;
        bottom: 32px;
      }
    }

    @media (prefers-reduced-motion: reduce) {
      * {
        animation-duration: 0.001ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.001ms !important;
      }
      body {
        background-attachment: scroll;
      }
    }
  </style>
  <script>
    const GIRLFRIEND_NAME = "Julia"; // editable
    const MY_NAME = "Wiktor"; // editable
    const DATE_IDEA = "Romantic dinner + stargazing"; // editable
    const DATE_TIME = "Feb 14, 7:00 PM"; // editable
    const PROMISE = "I will bring your favorite flowers."; // editable
    const COUNTDOWN_TARGET = "2026-02-14T19:00:00"; // editable (local time)
    const LOVE_LETTER = "From the moment we met, everything felt a little brighter. I love your laugh, your kindness, and the way you make even ordinary moments feel special. I can't wait to make new memories with you."; // editable
    const PS_LINE = "P.S. I still get butterflies around you."; // editable
  </script>
</head>
<body>
  <div class="bg-overlay" aria-hidden="true"></div>
  <div class="floating-hearts" aria-hidden="true"></div>

  <main class="page" role="main">
    <div class="stickers" aria-hidden="true">
      <img class="sticker s1" data-sticker="1" alt="" />
      <img class="sticker s2" data-sticker="2" alt="" />
      <img class="sticker s3" data-sticker="3" alt="" />
    </div>

    <section class="card" id="card">
      <div class="card-inner">
        <div class="letter">
          <div class="view view-question active" id="questionView">
            <div class="letter-meta">
              <span>To: <strong id="toName">Julia</strong></span>
              <span>From: <strong id="fromName">Wiktor</strong></span>
              <span class="letter-date" id="todayDate"></span>
            </div>

            <p class="eyebrow">A tiny question for you</p>
            <h1 id="mainQuestion"><span class="name-script" id="nameSlot">Julia</span>, will you be my Valentine?</h1>
            <p class="subtext">One day. One date. One very happy us.</p>

            <div class="cta-area" id="ctaArea">
              <button class="btn yes" id="yesBtn" aria-label="Say yes">YES</button>
              <button class="btn no" id="noBtn" aria-label="Say no">NO</button>
            </div>

            <p class="hint" id="hint" aria-live="polite"></p>
            <p class="tease" id="tease" aria-live="polite"></p>
            <p class="signature">Love, <span id="myNameInline">Wiktor</span></p>

            <div class="sound-toggle">
              <button id="muteBtn" type="button" aria-pressed="false">Sound: On</button>
            </div>
          </div>

          <div class="view view-success" id="successView" aria-live="polite">
            <div class="success-emoji" aria-hidden="true">💖</div>
            <h2 id="successHeading" tabindex="-1">YAY!! 💖 I’m taking you on a proper Valentine’s date. Dress cute. I’ll handle the rest 😉</h2>
            <p class="success-text">Get ready for a sweet little adventure made just for us.</p>
            <p class="success-text"><strong>Countdown:</strong> <span id="countdown">Calculating...</span></p>

            <details>
              <summary>Plan details</summary>
              <ul>
                <li><strong>Date idea:</strong> <span id="planIdea"></span></li>
                <li><strong>Time:</strong> <span id="planTime"></span></li>
                <li><strong>Little promise:</strong> <span id="planPromise"></span></li>
              </ul>
            </details>

            <div class="love-letter" id="loveLetter">
              <p class="seal-note">Break the seal to read your love letter.</p>
              <div class="envelope">
                <div class="letter-paper" id="letterPaper">
                  <div class="letter-body" id="letterBody" aria-hidden="true">
                    <p id="loveLetterText" class="love-letter-text"></p>
                  </div>
                </div>
                <button class="wax-seal" id="sealBtn" type="button" aria-label="Break wax seal to reveal the love letter">❤</button>
                <div class="envelope-front" aria-hidden="true"></div>
                <div class="envelope-flap" aria-hidden="true"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <footer>Made with love by <span id="myName">Wik</span></footer>
  </main>

  <div class="confetti" id="confetti" aria-hidden="true"></div>
  <div id="status" class="sr-only" aria-live="polite"></div>

  <script>
    (() => {
      const withSig = (url, sig) => `${url}${url.includes("?") ? "&" : "?"}sig=${sig}`;
      const BG_OPTIONS = [
        withSig("https://source.unsplash.com/random/1600x900?valentine,hearts", 1),
        withSig("https://source.unsplash.com/random/1600x900?romantic,flowers,pink", 2),
        withSig("https://source.unsplash.com/random/1600x900?love,roses,soft", 3)
      ];

      const STICKERS = [
        withSig("https://source.unsplash.com/random/300x300?heart", 11),
        withSig("https://source.unsplash.com/random/300x300?rose", 12),
        withSig("https://source.unsplash.com/random/300x300?sparkles", 13)
      ];

      const reduceMotion = window.matchMedia("(prefers-reduced-motion: reduce)").matches;
      if (reduceMotion) {
        document.documentElement.classList.add("reduce-motion");
      }

      const shuffle = (array) => {
        const arr = [...array];
        for (let i = arr.length - 1; i > 0; i -= 1) {
          const j = Math.floor(Math.random() * (i + 1));
          [arr[i], arr[j]] = [arr[j], arr[i]];
        }
        return arr;
      };

      const loadFirstAvailable = (urls, onSuccess, onFailure) => {
        const queue = [...urls];
        const tryNext = () => {
          if (!queue.length) {
            if (onFailure) onFailure();
            return;
          }
          const url = queue.shift();
          const img = new Image();
          img.referrerPolicy = "no-referrer";
          img.onload = () => onSuccess(url);
          img.onerror = () => tryNext();
          img.src = url;
        };
        tryNext();
      };

      loadFirstAvailable(shuffle(BG_OPTIONS), (url) => {
        document.documentElement.style.setProperty("--bg-image", `url('${url}')`);
      }, () => {
        document.documentElement.style.setProperty("--bg-image", "none");
      });

      document.querySelectorAll("[data-sticker]").forEach((el, idx) => {
        const rotated = STICKERS.slice(idx).concat(STICKERS.slice(0, idx));
        loadFirstAvailable(shuffle(rotated), (url) => {
          el.src = url;
        }, () => {
          el.style.display = "none";
        });
      });

      const nameSlot = document.getElementById("nameSlot");
      nameSlot.textContent = GIRLFRIEND_NAME;
      document.getElementById("toName").textContent = GIRLFRIEND_NAME;
      document.getElementById("fromName").textContent = MY_NAME;
      document.getElementById("myNameInline").textContent = MY_NAME;
      document.getElementById("myName").textContent = MY_NAME;
      document.getElementById("todayDate").textContent = new Date().toLocaleDateString(undefined, {
        year: "numeric",
        month: "long",
        day: "numeric"
      });
      document.getElementById("planIdea").textContent = DATE_IDEA;
      document.getElementById("planTime").textContent = DATE_TIME;
      document.getElementById("planPromise").textContent = PROMISE;

      const yesBtn = document.getElementById("yesBtn");
      const noBtn = document.getElementById("noBtn");
      const ctaArea = document.getElementById("ctaArea");
      const hint = document.getElementById("hint");
      const tease = document.getElementById("tease");
      const questionView = document.getElementById("questionView");
      const successView = document.getElementById("successView");
      const successHeading = document.getElementById("successHeading");
      const status = document.getElementById("status");
      const confetti = document.getElementById("confetti");
      const muteBtn = document.getElementById("muteBtn");
      const countdown = document.getElementById("countdown");
      const loveLetter = document.getElementById("loveLetter");
      const sealBtn = document.getElementById("sealBtn");
      const letterBody = document.getElementById("letterBody");
      const loveLetterText = document.getElementById("loveLetterText");
      const card = document.getElementById("card");

      let attempts = 0;
      const hintThreshold = Math.floor(8 + Math.random() * 5);
      let lastDodge = 0;
      let soundEnabled = true;
      let skipNoClick = false;
      let letterRevealed = false;
      let letterTimer = null;

      const showHint = () => {
        hint.textContent = "Just press YES, you know you want to 💘";
        hint.classList.add("show");
      };

      const showTease = () => {
        tease.textContent = "Nice try 😌 but you’re stuck with me.";
        tease.classList.add("show");
        setTimeout(() => tease.classList.remove("show"), 2400);
      };

      const rectRelative = (el, areaRect) => {
        const r = el.getBoundingClientRect();
        return {
          left: r.left - areaRect.left,
          top: r.top - areaRect.top,
          right: r.right - areaRect.left,
          bottom: r.bottom - areaRect.top,
          width: r.width,
          height: r.height
        };
      };

      const placeNoButton = (x, y) => {
        noBtn.style.transform = `translate(${x}px, ${y}px)`;
      };

      const moveNoButton = () => {
        const areaRect = ctaArea.getBoundingClientRect();
        const yesRect = rectRelative(yesBtn, areaRect);
        const noRect = rectRelative(noBtn, areaRect);
        const padding = 8;
        const minGap = 14;
        const maxX = Math.max(padding, areaRect.width - noRect.width - padding);
        const maxY = Math.max(padding, areaRect.height - noRect.height - padding);

        let x = 0;
        let y = 0;
        let tries = 0;
        while (tries < 60) {
          x = padding + Math.random() * (maxX - padding);
          y = padding + Math.random() * (maxY - padding);
          const candidate = {
            left: x,
            right: x + noRect.width,
            top: y,
            bottom: y + noRect.height
          };
          const overlap = !(
            candidate.right < yesRect.left - minGap ||
            candidate.left > yesRect.right + minGap ||
            candidate.bottom < yesRect.top - minGap ||
            candidate.top > yesRect.bottom + minGap
          );
          if (!overlap) {
            break;
          }
          tries += 1;
        }

        x = Math.min(Math.max(padding, x), maxX);
        y = Math.min(Math.max(padding, y), maxY);
        placeNoButton(x, y);
        return true;
      };

      const dodge = () => {
        const now = Date.now();
        if (now - lastDodge < 120) {
          return false;
        }
        lastDodge = now;
        attempts += 1;
        if (attempts >= hintThreshold) {
          showHint();
        }
        if (Math.random() < 0.15) {
          return false;
        }
        return moveNoButton();
      };

      const initNoPosition = () => {
        const areaRect = ctaArea.getBoundingClientRect();
        const yesRect = rectRelative(yesBtn, areaRect);
        const noRect = rectRelative(noBtn, areaRect);
        const padding = 10;
        const minGap = 14;
        let x = yesRect.right + 16;
        let y = yesRect.top;
        const maxX = Math.max(padding, areaRect.width - noRect.width - padding);
        const maxY = Math.max(padding, areaRect.height - noRect.height - padding);

        if (x > maxX) {
          x = yesRect.left - noRect.width - 16;
        }
        if (x < padding) {
          x = maxX;
        }
        if (y > maxY) {
          y = maxY;
        }
        if (y < padding) {
          y = padding;
        }
        placeNoButton(x, y);
        const placed = {
          left: x,
          right: x + noRect.width,
          top: y,
          bottom: y + noRect.height
        };
        const overlap = !(
          placed.right < yesRect.left - minGap ||
          placed.left > yesRect.right + minGap ||
          placed.bottom < yesRect.top - minGap ||
          placed.top > yesRect.bottom + minGap
        );
        if (overlap) {
          moveNoButton();
        }
      };

      const handleMouseMove = (event) => {
        const noRect = noBtn.getBoundingClientRect();
        const cx = noRect.left + noRect.width / 2;
        const cy = noRect.top + noRect.height / 2;
        const dist = Math.hypot(event.clientX - cx, event.clientY - cy);
        if (dist < 90) {
          const moved = dodge();
          if (moved) {
            skipNoClick = true;
            setTimeout(() => {
              skipNoClick = false;
            }, 200);
          }
        }
      };

      const createFloatingHearts = () => {
        if (reduceMotion) return;
        const container = document.querySelector(".floating-hearts");
        const count = 14;
        for (let i = 0; i < count; i += 1) {
          const span = document.createElement("span");
          span.textContent = "❤";
          span.style.setProperty("--x", `${Math.random() * 100}%`);
          span.style.setProperty("--size", `${12 + Math.random() * 16}px`);
          span.style.setProperty("--opacity", `${0.2 + Math.random() * 0.4}`);
          span.style.setProperty("--duration", `${10 + Math.random() * 10}s`);
          span.style.setProperty("--delay", `${Math.random() * 6}s`);
          container.appendChild(span);
        }
      };

      const startConfetti = () => {
        if (reduceMotion) return;
        confetti.innerHTML = "";
        const hearts = ["💗", "💖", "💘", "💝"];
        const count = 56;
        for (let i = 0; i < count; i += 1) {
          const span = document.createElement("span");
          span.className = "confetti-heart";
          span.textContent = hearts[Math.floor(Math.random() * hearts.length)];
          span.style.setProperty("--x", `${Math.random() * 100}%`);
          span.style.setProperty("--size", `${12 + Math.random() * 16}px`);
          span.style.setProperty("--duration", `${3.4 + Math.random() * 2.4}s`);
          span.style.setProperty("--delay", `${Math.random() * 0.8}s`);
          confetti.appendChild(span);
        }
        setTimeout(() => {
          confetti.innerHTML = "";
        }, 7000);
      };

      const playChime = () => {
        if (!soundEnabled) return;
        const AudioCtx = window.AudioContext || window.webkitAudioContext;
        if (!AudioCtx) return;
        const ctx = new AudioCtx();
        const now = ctx.currentTime;
        const notes = [523.25, 659.25, 783.99];
        notes.forEach((freq, i) => {
          const osc = ctx.createOscillator();
          const gain = ctx.createGain();
          osc.type = "sine";
          osc.frequency.setValueAtTime(freq, now + i * 0.12);
          gain.gain.setValueAtTime(0.0001, now + i * 0.12);
          gain.gain.exponentialRampToValueAtTime(0.15, now + i * 0.12 + 0.02);
          gain.gain.exponentialRampToValueAtTime(0.0001, now + i * 0.12 + 0.3);
          osc.connect(gain).connect(ctx.destination);
          osc.start(now + i * 0.12);
          osc.stop(now + i * 0.12 + 0.32);
        });
        setTimeout(() => ctx.close(), 1200);
      };

      const revealLoveLetter = () => {
        if (letterRevealed) return;
        letterRevealed = true;
        loveLetter.classList.add("open");
        letterBody.setAttribute("aria-hidden", "false");
        sealBtn.classList.add("broken");
        sealBtn.disabled = true;
        status.textContent = "Love letter opened.";
        const fullText = `${LOVE_LETTER}\n\n${PS_LINE}`;
        if (reduceMotion) {
          loveLetterText.textContent = fullText;
          return;
        }
        loveLetterText.textContent = "";
        let idx = 0;
        const speed = 16;
        const typeNext = () => {
          loveLetterText.textContent = fullText.slice(0, idx);
          idx += 1;
          if (idx <= fullText.length) {
            letterTimer = setTimeout(typeNext, speed);
          }
        };
        typeNext();
      };

      const updateCountdown = () => {
        const target = new Date(COUNTDOWN_TARGET);
        if (Number.isNaN(target.getTime())) {
          countdown.textContent = "Set your date above!";
          return;
        }
        const now = new Date();
        const diff = target.getTime() - now.getTime();
        if (diff <= 0) {
          countdown.textContent = "It’s time! 💞";
          return;
        }
        const totalSeconds = Math.floor(diff / 1000);
        const days = Math.floor(totalSeconds / 86400);
        const hours = Math.floor((totalSeconds % 86400) / 3600);
        const minutes = Math.floor((totalSeconds % 3600) / 60);
        const seconds = totalSeconds % 60;
        countdown.textContent = `${days}d ${hours}h ${minutes}m ${seconds}s`;
      };

      yesBtn.addEventListener("click", () => {
        questionView.classList.remove("active");
        successView.classList.add("active");
        card.classList.add("opened");
        startConfetti();
        playChime();
        status.textContent = "Success! The yes response is selected.";
        successHeading.focus();
      });

      noBtn.addEventListener("click", (event) => {
        event.preventDefault();
        if (skipNoClick) {
          skipNoClick = false;
          return;
        }
        showTease();
      });

      noBtn.addEventListener("mouseenter", () => {
        const moved = dodge();
        if (moved) {
          skipNoClick = true;
          setTimeout(() => {
            skipNoClick = false;
          }, 200);
        }
      });
      ctaArea.addEventListener("mousemove", handleMouseMove);
      noBtn.addEventListener("pointerdown", (event) => {
        if (event.pointerType === "touch") {
          const moved = dodge();
          if (moved) {
            skipNoClick = true;
            event.preventDefault();
            setTimeout(() => {
              skipNoClick = false;
            }, 200);
          }
        }
      });

      muteBtn.addEventListener("click", () => {
        soundEnabled = !soundEnabled;
        muteBtn.textContent = soundEnabled ? "Sound: On" : "Sound: Off";
        muteBtn.setAttribute("aria-pressed", String(!soundEnabled));
      });

      sealBtn.addEventListener("click", () => {
        revealLoveLetter();
      });

      window.addEventListener("resize", () => {
        initNoPosition();
      });

      updateCountdown();
      setInterval(updateCountdown, 1000);
      createFloatingHearts();
      initNoPosition();
      window.addEventListener("load", () => document.body.classList.add("loaded"));
    })();
  </script>
</body>
</html>
